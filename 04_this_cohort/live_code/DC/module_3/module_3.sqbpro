<<<<<<< HEAD
<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="C:/Users/ofirs/OneDrive/Desktop/DSI PRACTICE/sql/05_src/sql/farmersmarket.db" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser pragmas query" current="3"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="100"/><column_width id="3" width="12652"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/><expanded_item id="4" parent="1"/></tab_structure><tab_browse><table title="booth" custom_title="0" dock_id="4" table="4,5:mainbooth"/><table title="temp.new_customer_purchases" custom_title="0" dock_id="26" table="4,22:tempnew_customer_purchases"/><dock_state state="000000ff00000000fd0000000100000002000004dc000002a2fc0100000006fb000000160064006f0063006b00420072006f00770073006500310100000000ffffffff0000000000000000fb000000160064006f0063006b00420072006f00770073006500320100000000000005360000000000000000fc00000000000004630000000000fffffffa000000000100000001fb000000180064006f0063006b00420072006f007700730065003100380100000000ffffffff0000000000000000fc00000000000004b40000000000fffffffa000000000100000007fb000000180064006f0063006b00420072006f007700730065003200370100000000ffffffff0000000000000000fb000000180064006f0063006b00420072006f007700730065003200380100000000ffffffff0000000000000000fb000000180064006f0063006b00420072006f007700730065003200390100000000ffffffff0000000000000000fb000000180064006f0063006b00420072006f007700730065003300300100000000ffffffff0000000000000000fb000000180064006f0063006b00420072006f007700730065003300310100000000ffffffff0000000000000000fb000000180064006f0063006b00420072006f007700730065003300320100000000ffffffff0000000000000000fb000000180064006f0063006b00420072006f007700730065003100300100000000ffffffff0000000000000000fb000000180064006f0063006b00420072006f007700730065003100310100000000000005f40000000000000000fc00000000000004dc000001c100fffffffa000000010100000002fb000000160064006f0063006b00420072006f00770073006500340100000000ffffffff000001c100fffffffb000000180064006f0063006b00420072006f007700730065003200360100000000ffffffff000001c100ffffff000004dc0000000000000004000000040000000800000008fc00000000"/><default_encoding codec=""/><browse_table_settings><table schema="main" name="booth" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="128"/><column index="2" value="153"/><column index="3" value="300"/><column index="4" value="101"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="temp" name="new_customer_purchases" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort><column index="2" mode="0"/></sort><column_widths><column index="1" value="96"/><column index="2" value="89"/><column index="3" value="112"/><column index="4" value="109"/><column index="5" value="76"/><column index="6" value="226"/><column index="7" value="146"/><column index="8" value="122"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table></browse_table_settings></tab_browse><tab_sql><sql name="SQL 1">/* MODULE 3 */
=======
<?xml version="1.0" encoding="UTF-8"?><sqlb_project><window><main_tabs open="structure browser pragmas query" current="3"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="100"/><column_width id="3" width="12168"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/><expanded_item id="4" parent="1"/></tab_structure><tab_browse><table title="product" custom_title="0" dock_id="4" table="4,7:mainproduct"/><table title="customer_purchases" custom_title="0" dock_id="7" table="4,18:maincustomer_purchases"/><table title="temp.new_new_vendor_inventory" custom_title="0" dock_id="9" table="4,24:tempnew_new_vendor_inventory"/><table title="temp.new_vendor_inventory" custom_title="0" dock_id="8" table="4,20:tempnew_vendor_inventory"/><dock_state state="000000ff00000000fd000000010000000200000546000003a1fc0100000003fb000000160064006f0063006b00420072006f00770073006500310100000000ffffffff0000000000000000fb000000160064006f0063006b00420072006f00770073006500320100000000000005360000000000000000fc00000000000005460000013e00fffffffa000000010100000004fb000000160064006f0063006b00420072006f00770073006500340100000000ffffffff0000013500fffffffb000000160064006f0063006b00420072006f00770073006500370100000000ffffffff0000011e00fffffffb000000160064006f0063006b00420072006f00770073006500380100000000ffffffff0000013e00fffffffb000000160064006f0063006b00420072006f00770073006500390100000000ffffffff0000013e00ffffff000005460000000000000004000000040000000800000008fc00000000"/><default_encoding codec=""/><browse_table_settings><table schema="main" name="booth" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="136"/><column index="2" value="164"/><column index="3" value="300"/><column index="4" value="108"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="customer_purchases" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="103"/><column index="2" value="94"/><column index="3" value="118"/><column index="4" value="119"/><column index="5" value="80"/><column index="6" value="242"/><column index="7" value="155"/></column_widths><filter_values><column index="2" value="2022-04-05"/><column index="1" value="7"/></filter_values><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="market_date_info" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort><column index="10" mode="1"/></sort><column_widths><column index="1" value="118"/><column index="2" value="111"/><column index="3" value="124"/><column index="4" value="118"/><column index="5" value="170"/><column index="6" value="161"/><column index="7" value="129"/><column index="8" value="176"/><column index="9" value="167"/><column index="10" value="172"/><column index="11" value="156"/><column index="12" value="168"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="product" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort><column index="0" mode="0"/></sort><column_widths><column index="1" value="103"/><column index="2" value="300"/><column index="3" value="134"/><column index="4" value="191"/><column index="5" value="163"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="temp" name="new_new_vendor_inventory" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="118"/><column index="2" value="80"/><column index="3" value="94"/><column index="4" value="103"/><column index="5" value="127"/><column index="6" value="79"/><column index="7" value="138"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="temp" name="new_vendor_inventory" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="118"/><column index="2" value="80"/><column index="3" value="94"/><column index="4" value="103"/><column index="5" value="127"/><column index="6" value="79"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="vendor_inventory" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="118"/><column index="2" value="80"/><column index="3" value="97"/><column index="4" value="106"/><column index="5" value="127"/></column_widths><filter_values><column index="4" value="18"/></filter_values><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table></browse_table_settings></tab_browse><tab_sql><sql name="COUNT*">/* MODULE 3 */
>>>>>>> eba6c4977c09aa65ee87a00aa06ac551f1891f43
/* COUNT */


/* 1. Count the number of products */
<<<<<<< HEAD
SELECT count (product_id) as num_of_product
FROM product;
=======
 SELECT COUNT(product_id) as num_of_product
 FROM product;
>>>>>>> eba6c4977c09aa65ee87a00aa06ac551f1891f43

/* 2. How many products per product_qty_type */
<<<<<<< HEAD
 SELECT product_qty_type, COUNT (product_id) as num_of_product
 FROM product
 GROUP BY product_qty_type;

/* 3. How many products per product_qty_type and per their product_size */
 SELECT product_size,
 product_qty_type,
 COUNT (product_id) as num_of_product
 FROM product
 GROUP BY product_size, product_qty_type
 ORDER BY product_qty_type;
/* COUNT DISTINCT 
    4. How many unique products were bought*/
SELECT COUNT(DISTINCT product_id) as bought_product
FROM customer_purchases; 

SELECT COUNT(product_id) as bought_product
FROM customer_purchases
</sql><sql name="SQL 10">/* MODULE 3 */
/* SUM &amp; AVG */


/* 1. How much did customers spend each day */
SELECT
market_date, 
customer_id, 
SUM(quantity*cost_to_customer_per_qty) as total_cost

FROM customer_purchases
GROUP BY customer_id, market_date
ORDER BY market_date;
 

/* 2. How much does each customer spend on average */
SELECT
customer_first_name, 
customer_last_name, 
AVG (quantity*cost_to_customer_per_qty) as avg_spend 
FROM customer_purchases as cp
INNER JOIN customer as c
	ON c.customer_id = cp. customer_id
GROUP BY c.customer_id;
=======
SELECT product_qty_type, COUNT(product_id) as num_of_product
FROM product
GROUP BY product_qty_type;

/* 3. How many products per product_qty_type and per their product_size */
SELECT product_size
,product_qty_type
, COUNT(product_id) as num_of_product
FROM product
GROUP BY product_size, product_qty_type

ORDER BY product_qty_type;

/* COUNT DISTINCT 
    4. How many unique products were bought */
SELECT COUNT(DISTINCT product_id) as bought_prods
FROM customer_purchases

</sql><sql name="SUM_AVG*">/* MODULE 3 */
/* SUM &amp; AVG */


/* 1. How much did customers spend each (per) day */
SELECT
market_date
,customer_id
,SUM(quantity*cost_to_customer_per_qty) as total_spend

FROM customer_purchases
GROUP BY market_date,customer_id;
 

/* 2. How much does each customer spend on average */
SELECT 
customer_first_name
,customer_last_name
,ROUND(AVG(quantity*cost_to_customer_per_qty),2) as avg_spend

FROM customer_purchases as cp
INNER JOIN customer as c
	ON c.customer_id = cp.customer_id

GROUP BY c.customer_id
>>>>>>> eba6c4977c09aa65ee87a00aa06ac551f1891f43

SELECT
customer_first_name, 
customer_last_name, 
ROUND (AVG (quantity*cost_to_customer_per_qty),2) as avg_spend 
FROM customer_purchases as cp
INNER JOIN customer as c
	ON c.customer_id = cp. customer_id
GROUP BY c.customer_id
ORDER BY customer_first_name; 

<<<<<<< HEAD
SELECT
customer_first_name, 
customer_last_name, 
market_date,
ROUND (AVG (quantity*cost_to_customer_per_qty),2) as avg_spend 
FROM customer_purchases as cp
INNER JOIN customer as c
	ON c.customer_id = cp. customer_id
GROUP BY c.customer_id, market_date
ORDER BY customer_first_name, market_date</sql><sql name="SQL 11">/* MODULE 3 */
=======
</sql><sql name="MIN_MAX*">/* MODULE 3 */
>>>>>>> eba6c4977c09aa65ee87a00aa06ac551f1891f43
/* MIN &amp; MAX */


/* 1. What is the most expensive product 
...pay attention to how it doesn't handle ties very well
*/
<<<<<<< HEAD

SELECT 
product_name,
max (original_price) as most_expesive_product

FROM vendor_inventory as vi
INNER JOIN product as p
	ON p.product_id = vi.product_id;

=======
SELECT product_name, max(original_price)  as most_expensive

FROM vendor_inventory as vi
INNER JOIN product as p 
	ON p.product_id = vi.product_id;
 
>>>>>>> eba6c4977c09aa65ee87a00aa06ac551f1891f43

/* 2. Prove that max is working */
SELECT DISTINCT
product_name,
original_price

<<<<<<< HEAD
SELECT DISTINCT
product_name, 
original_price
=======
FROM vendor_inventory as vi
INNER JOIN product as p 
	ON p.product_id = vi.product_id;
>>>>>>> eba6c4977c09aa65ee87a00aa06ac551f1891f43

FROM 
vendor_inventory as vi
INNER JOIN product as p
	ON p.product_id = vi.product_id
 ORDER BY original_price;
 
/* 3. Find the minimum price per each product_qty_type */
<<<<<<< HEAD
SELECT 
product_name,
product_qty_type, 
min (original_price)

FROM vendor_inventory as vi 
INNER JOIN product as p
	ON p.product_id = vi.product_id

GROUP BY product_qty_type;
=======
SELECT product_name
,product_qty_type
,min(original_price)

FROM vendor_inventory as vi
INNER JOIN product as p
	ON p.product_id = vi.product_id
>>>>>>> eba6c4977c09aa65ee87a00aa06ac551f1891f43

GROUP BY product_qty_type;

/* 4. Prove that min is working */
SELECT DISTINCT product_name
,product_qty_type
--,min(original_price)
,original_price

<<<<<<< HEAD
SELECT DISTINCT
product_name, 
original_price, 
product_qty_type

FROM vendor_inventory as vi 
INNER JOIN product as p
	ON p.product_id = vi.product_id
ORDER BY product_qty_type, original_price;

=======
FROM vendor_inventory as vi
INNER JOIN product as p
	ON p.product_id = vi.product_id;
>>>>>>> eba6c4977c09aa65ee87a00aa06ac551f1891f43

/* 5. Min/max on a string 
... not particularly useful? */
SELECT max(product_name)
FROM product

<<<<<<< HEAD
SELECT min (product_name)
FROM product; 

SELECT max (product_name)
FROM product; 

</sql><sql name="SQL 12">/* MODULE 3 */
=======
</sql><sql name="arithmitic*">/* MODULE 3 */
>>>>>>> eba6c4977c09aa65ee87a00aa06ac551f1891f43
/* Arithmitic */


/* 1. power, pi(), ceiling, division, integer division, etc */
<<<<<<< HEAD
SELECT 
power (4,2), pi();
SELECT
CAST(10.0 as INT)/CAST(3.0 as INT) as integer_devision;

/* 2. Every even vendor_id with modulo */
SELECT * FROM vendor
WHERE vendor_id%2 = 0; 

--odd 
SELECT * FROM vendor
WHERE vendor_id%2 != 0;

/* 3. What about every third?  */
SELECT * FROM vendor
WHERE vendor_id%3 =0
</sql><sql name="SQL 13">/* MODULE 3 */
=======
SELECT power(4,2), pi();

SELECT 10.0 / 3.0 as division,
CAST(10.0 as INT) / CAST(3.0 as INT) as integer_division;

/* 2. Every even vendor_id with modulo */
SELECT * FROM vendor
WHERE vendor_id % 2 = 0;

/* 3. What about every third?  */
SELECT * FROM vendor
WHERE vendor_id % 3 = 0;

</sql><sql name="HAVING*">/* MODULE 3 */
>>>>>>> eba6c4977c09aa65ee87a00aa06ac551f1891f43
/* HAVING */


/* 1. How much did a customer spend on each day?
Filter to customer_id between 1 and 5 and total_spend &gt; 50 
... What order of execution occurs?*/
<<<<<<< HEAD
 SELECT
 market_date, 
 customer_id, 
 SUM (quantity*cost_to_customer_per_qty) as total_spend
 FROM customer_purchases
 WHERE customer_id BETWEEN 1 AND 5

 GROUP BY market_date, customer_id
 HAVING total_spend &gt;50
 ORDER BY customer_id, market_date;
=======
SELECT 
market_date
,customer_id
,SUM(quantity*cost_to_customer_per_qty) as total_spend
>>>>>>> eba6c4977c09aa65ee87a00aa06ac551f1891f43

FROM customer_purchases
WHERE customer_id BETWEEN 1 AND 5

GROUP BY market_date, customer_id 
HAVING total_spend &gt; 50;

/* 2. How many products were bought?
Filter to number of purchases between 300 and 500  */
<<<<<<< HEAD
SELECT count (product_id) as number_of_product, 
product_id
 FROM customer_purchases
 GROUP BY product_id
 HAVING count (product_id) BETWEEN 300 AND 500

</sql><sql name="SQL 13">	/* MODULE 3 */
=======
SELECT count(product_id) as num_of_prod, product_id
FROM customer_purchases
GROUP BY product_id
HAVING count(product_id) BETWEEN 300 AND 500


</sql><sql name="subquery_joins*">/* MODULE 3 */
>>>>>>> eba6c4977c09aa65ee87a00aa06ac551f1891f43
/* Subquery FROM */


/*1. Simple subquery in a FROM statement, e.g. for inflation
...we could imagine joining this to a more complex query perhaps */
SELECT DISTINCT
product_id, inflation

FROM (
	SELECT product_id, cost_to_customer_per_qty,
	CASE WHEN cost_to_customer_per_qty &lt; '1.00' THEN cost_to_customer_per_qty*5
<<<<<<< HEAD
	ELSE cost_to_customer_per_qty 
	END as inflation
	
	FROM customer_purchases
); 

=======
	ELSE cost_to_customer_per_qty END AS inflation
	
	FROM customer_purchases
);
>>>>>>> eba6c4977c09aa65ee87a00aa06ac551f1891f43


/* 2. What is the single item that has been bought in the greatest quantity?*/
--outer query
SELECT product_name, MAX(quantity_purchased)

<<<<<<< HEAD
SELECT
product_name, max (quntity_purchased)
FROM product as p
INNER JOIN (
	SELECT product_id, 
	count (quantity) as quntity_purchased
	FROM customer_purchases
	GROUP BY product_id

) as x 
	ON p.product_id = x.product_id
=======
FROM product AS p
INNER JOIN (
-- inner query
	SELECT product_id
	,count(quantity) as quantity_purchased
>>>>>>> eba6c4977c09aa65ee87a00aa06ac551f1891f43

	FROM customer_purchases
	GROUP BY product_id
) AS x ON p.product_id = x.product_id

</sql><sql name="subquery_where*">/* MODULE 3 */
/* Subquery WHERE */


/* 1. How much did each customer spend at each vendor for each day at the market WHEN IT RAINS */

<<<<<<< HEAD
SELECT
market_date, 
customer_id, 
vendor_id, 
SUM (quantity*cost_to_customer_per_qty) as total_spend
=======
SELECT 
market_date,
customer_id,
vendor_id,
SUM(quantity*cost_to_customer_per_qty) as total_spend

FROM customer_purchases

-- filter by rain_flag
-- &quot;what dates was it raining&quot;
WHERE market_date IN (
	SELECT market_date
	FROM market_date_info
	WHERE market_rain_flag = 1
)

GROUP BY market_date, vendor_id, customer_id;
>>>>>>> eba6c4977c09aa65ee87a00aa06ac551f1891f43

FROM customer_purchases

WHERE market_date IN (
	SELECT market_date
	FROM market_date_info
	WHERE market_rain_flag = 1
)
GROUP BY market_date, vendor_id, market_date;

/* 2. What is the name of the vendor who sells pie */
SELECT DISTINCT vendor_name

<<<<<<< HEAD
FROM customer_purchases as cp 
=======
SELECT DISTINCT vendor_name

FROM customer_purchases as cp
>>>>>>> eba6c4977c09aa65ee87a00aa06ac551f1891f43
INNER JOIN vendor as v
	ON cp.vendor_id = v.vendor_id
	
WHERE product_id IN (
	SELECT product_id
	FROM product
<<<<<<< HEAD
	WHERE product_name like '%pie%'
	)
</sql><sql name="SQL 15">/* MODULE 3 */
/* Common Table Expression (CTE) */


/* 1. Calculate sales per vendor per day */
WITH vendor_daily_sales AS (
	SELECT
	md.market_date,
	market_day, 
	market_week, 
	market_year, 
	vendor_name, 
	SUM (quantity*cost_to_customer_per_qty) as sales
	 
	FROM customer_purchases as cp
	INNER JOIN vendor as v 
		ON v.vendor_id = cp.vendor_id
	INNER JOIN  market_date_info as md 
		ON cp.market_date = md.market_date
		
	GROUP BY md.market_date, v.vendor_id

)

/* ... re-aggregate the daily sales for each WEEK instead now  */

SELECT 
market_week, 
market_year, 
vendor_name, 
sum (sales) as sales 

FROM vendor_daily_sales
GROUP BY market_year, market_week, vendor_name
ORDER BY vendor_name, market_week</sql><sql name="SQL 16">/* MODULE 3 */
=======
	WHERE product_name LIKE '%pie%'
)


</sql><sql name="temp_table*">/* MODULE 3 */
>>>>>>> eba6c4977c09aa65ee87a00aa06ac551f1891f43
/* Temp Tables */


/* 1. Put our inflation query into a temp table, e.g. as temp.new_vendor_inventory*/

/* some structural code */
/* ...heads up, sometimes this query can be finnicky -- it's good to try highlighting different sections to help it succeed...*/

-- if a table named new_vendor_inventory exists, delete it, other do NOTHING
DROP TABLE IF EXISTS temp.new_vendor_inventory;

--make the table
CREATE TABLE temp.new_vendor_inventory AS

-- definition of the table
<<<<<<< HEAD
SELECT *,
original_price*5 as inflation 
FROM vendor_inventory; 



=======
SELECT *, 
original_price*5 as inflation
FROM vendor_inventory;
>>>>>>> eba6c4977c09aa65ee87a00aa06ac551f1891f43


/* 2. put the previous table into another temp table, e.g. as temp.new_new_vendor_inventory  */
DROP TABLE IF EXISTS temp.new_new_vendor_inventory;
CREATE TABLE temp.new_new_vendor_inventory AS
<<<<<<< HEAD
SELECT *,
inflation*3 as super_inflation
FROM temp.new_vendor_inventory 
=======

SELECT * 
,inflation*2 as super_inflation
FROM temp.new_vendor_inventory

</sql><sql name="CTE*">/* MODULE 3 */
/* Common Table Expression (CTE) */

>>>>>>> eba6c4977c09aa65ee87a00aa06ac551f1891f43

/* 1. Calculate sales per vendor per day */
WITH vendor_daily_sales AS (
	SELECT 
	md.market_date
	,market_day
	,market_week
	,market_year
	,vendor_name
	,SUM(quantity*cost_to_customer_per_qty) as sales

	FROM customer_purchases cp
	INNER JOIN vendor v -- we want the vendor_name
		ON v.vendor_id = cp.vendor_id
	INNER JOIN market_date_info md -- all the date columns
		ON cp.market_date = md.market_date

	GROUP BY md.market_date, v.vendor_id

)


/* ... re-aggregate the daily sales for each WEEK instead now  */

SELECT 
market_year
,market_week
,vendor_name
,SUM(sales) as sales

FROM vendor_daily_sales
GROUP BY market_year,market_week, vendor_name



</sql><sql name="dates">/* MODULE 3 */
/* Date functions */


/* 1. now */
<<<<<<< HEAD
SELECT  
date ('now') as [now], 
datetime ('now') as [rightnow], 
date()as [today], 

/* 2. strftime */
strftime ('%Y/%m', 'now') as [i],
strftime ('%Y-%m-%d', 'now','+50 days') as the_future; 

SELECT DISTINCT
market_date,
strftime ('%Y-%m-%d',market_date,'+50 days','-1 year') as the_past

FROM
market_date_info
ORDER BY market_date; 
/* 3. adding dates, e.g. last date of the month */

--last date of last month
=======
SELECT DISTINCT
DATE('now') as [now]
,DATETIME('now') [rightnow]
,DATE() as[todaysdate]

/* 2. strftime */
,strftime('%Y/%m','now') as [1]
,strftime('%Y-%m-%d','now','+50 days') as the_future
,market_date 
,strftime('%m-%d-%Y',market_date,'+50 days','-1 year') as the_past

/* 3. adding dates, e.g. last date of the month */
--last date of last month
,DATE(market_date,'start of month','-1 day') as end_of_prev_month
>>>>>>> eba6c4977c09aa65ee87a00aa06ac551f1891f43

SELECT DISTINCT

date (market_date, 'start of month', '-1 day') as end_of_prev_month

From market_date_info; 
/* 4. difference between dates, 
 a. number of days between now and each market_date
 b. number of YEARS between now and market_date
 c. number of HOURS bewtween now and market_date
 */
<<<<<<< HEAD
 SELECT DISTINCT 
 julianday ('now') - julianday (market_date) as datebetweenmarketdates,
 (julianday ('now') - julianday (market_date)) /365.25 as differentyears, 
 (julianday ('now') - julianday (market_date))*24*60*60 as numberofseconds
 
 FROM market_date_info</sql><sql name="assignment2.sql" filename="C:/Users/ofirs/OneDrive/Desktop/DSI PRACTICE/sql/02_activities/assignments/DC_Cohort/assignment2.sql">-- Reference to file &quot;C:/Users/ofirs/OneDrive/Desktop/DSI PRACTICE/sql/02_activities/assignments/DC_Cohort/assignment2.sql&quot; (not supported by this version) --</sql><current_tab id="10"/></tab_sql></sqlb_project>
=======
 ,market_date
 ,julianday('now') - julianday(market_date) as datesbetweenmktdate -- number of days between now and each market date
,(julianday('now') - julianday(market_date)) / 365.25
,(julianday('now') - julianday(market_date)) * 24
 
 FROM market_date_info
</sql><current_tab id="0"/></tab_sql></sqlb_project>
>>>>>>> eba6c4977c09aa65ee87a00aa06ac551f1891f43
